generator client {
  provider = "prisma-client"
  output   = "./src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model Account {
  id                String  @id @default(cuid())
  userId            String  @map("user_id")
  type              String
  provider          String
  providerAccountId String  @map("provider_account_id")
  refresh_token     String? @db.Text
  access_token      String? @db.Text
  expires_at        Int?
  token_type        String?
  scope             String?
  id_token          String? @db.Text
  session_state     String?

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([provider, providerAccountId])
  @@map("accounts")
}

model User {
  id                 String             @id @default(cuid())
  name               String?
  email              String?            @unique
  password           String?
  emailVerified      DateTime?          @map("email_verified")
  image              String?
  phone              String?
  bio                String?
  gender             String?
  address            Json?
  role               Role               @default(CLIENT)
  userStatus         VerficationStatus  @default(PENDING)
  accounts           Account[]
  stripeCustomerId   String?            @unique
  subscriptionStatus SubscriptionStatus @default(NONE)
  createdAt          DateTime           @default(now())
  updatedAt          DateTime           @updatedAt

  @@map("users")
}

model ClassSchedule {
  id        String @id @default(cuid())
  className String
  trainer   String
  trainerId String

  schedule Json // ScheduleDay[]

  capacity      Int
  enrolledCount Int

  description String
  level       FitnessLevel
  category    ClassCategory

  duration Int // minutes
  price    Float

  isActive Boolean @default(true)

  startDate DateTime
  endDate   DateTime?

  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
  scheduleDays ScheduleDay[]
}

model ScheduleDay {
  id        String @id @default(cuid())
  day       String
  startTime String
  endTime   String

  classScheduleId String
  classSchedule   ClassSchedule @relation(fields: [classScheduleId], references: [id], onDelete: Cascade)
}

// ---------------------------------------------------------
//  Enums
// ---------------------------------------------------------

enum SubscriptionStatus {
  ACTIVE
  CANCELED
  PAST_DUE
  NONE
}

enum Difficulty {
  BEGINNER
  INTERMEDIATE
  ADVANCED
}

enum Role {
  CLIENT
  ADMIN
}

enum VerficationStatus {
  VERIFIED
  PENDING
  BLOCKED
}

enum FitnessLevel {
  Beginner
  Intermediate
  Advanced
}

enum ClassCategory {
  StrengthTraining
  Cardio
  Yoga
  Pilates
  CrossFit
  Boxing
  HIIT
  FunctionalFitness
}
